/**
* This file is part of the SSM_LinearArray (Sound Sources Mapping
* using a Linear Microphone Array)
* developed by Daobilige Su <daobilige DOT su AT student DOT uts DOT edu DOT au>
*  
* This file is under the GPLv3 licence. 
*/

#ifndef EKFJACOBIANS_H
#define EKFJACOBIANS_H

#include <Eigen/Dense>
#include <math.h>
#include "Converter.h"
#include <opencv2/core/core.hpp>

namespace ORB_SLAM2{

inline Eigen::MatrixXd jacobian_linear_to_azim_elev(){
	Eigen::MatrixXd F(8,3);
	F(5,0) = 1;
	F(6,1) = 1;
	F(7,2) = 1;

	return F;
}


inline Eigen::MatrixXd jacobian_ekf_update_3d_linear_hypo(Eigen::Matrix4d Mx, Eigen::MatrixXd lm){
	Eigen::MatrixXd mu = Converter::toSE3Quat(Converter::toCvMat(Mx)).toVector();

	double mu_x = mu(0,0);
	double mu_y = mu(1,0);
	double mu_z = mu(2,0);
	double mu_qr = mu(6,0);
	double mu_qx = mu(3,0);
	double mu_qy = mu(4,0);
	double mu_qz = mu(5,0);

	double lm_x = lm(0,0);
	double lm_y = lm(1,0);
	double lm_z = lm(2,0);
	double lm_azim = lm(3,0);
	double lm_elev = lm(4,0);
	double lm_axis = lm(5,0);
	double lm_circum = lm(6,0);
	double lm_idp = lm(7,0);
	
	Eigen::MatrixXd B(1,8);
	
	B << -1.0*((pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)/pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),0.5) + ((2*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)) - 2*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(2*pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),1.5))))/(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2) + pow(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)),2)), 
	((pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2))*((pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))/pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),0.5) + ((2*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)) + 2*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(2*pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),1.5))))/(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2) + pow(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)),2)), 
	((pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2))*((2*mu_qr*mu_qx + 2*mu_qy*mu_qz)/pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),0.5) - ((2*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + 2*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2))*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(2*pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),1.5))))/(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2) + pow(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)),2)), 
	((pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2))*((((cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) + (2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*((cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp))/pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),0.5) + ((2*((2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*((cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) + (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*((cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp))*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)) - 2*(((cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*((cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp))*((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(2*pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),1.5))))/(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2) + pow(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)),2)), 
	-1.0*(((((sin(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp)*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*((cos(lm_elev)*sin(lm_axis))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) + ((cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)))/pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),0.5) + ((2*(((sin(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp)*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + ((cos(lm_elev)*sin(lm_axis))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + ((cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_circum))/lm_idp)*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)) + 2*((2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*((cos(lm_elev)*sin(lm_axis))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - ((sin(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) + ((cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_circum))/lm_idp)*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy))*((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(2*pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),1.5)))*(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2)))/(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2) + pow(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)),2)), 
	((pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2))*(((2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*((cos(lm_axis)*sin(lm_elev))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_circum))/lm_idp) + ((cos(lm_elev)*cos(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_circum)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) + (2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*((cos(lm_elev)*cos(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_circum)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (sin(lm_elev)*sin(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp))/pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),0.5) - ((2*((2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*((cos(lm_axis)*sin(lm_elev))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_circum))/lm_idp) + ((cos(lm_elev)*cos(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_circum)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (sin(lm_elev)*sin(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*((cos(lm_elev)*cos(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_circum)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_axis)*sin(lm_circum))/lm_idp))*((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) - 2*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*((cos(lm_elev)*cos(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_circum)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_axis)*sin(lm_circum))/lm_idp) - ((cos(lm_axis)*sin(lm_elev))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*((cos(lm_elev)*cos(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_circum)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (sin(lm_elev)*sin(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp))*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(2*pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),1.5))))/(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2) + pow(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)),2)), 
	((pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2))*((((cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_circum))/lm_idp - (cos(lm_axis)*cos(lm_circum)*sin(lm_elev)*sin(lm_azim - M_PI/2))/lm_idp)*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - ((cos(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2)*sin(lm_elev))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) + (cos(lm_elev)*cos(lm_axis)*cos(lm_circum)*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))/lm_idp)/pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),0.5) - ((2*(((cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_circum))/lm_idp - (cos(lm_axis)*cos(lm_circum)*sin(lm_elev)*sin(lm_azim - M_PI/2))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) + ((cos(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2)*sin(lm_elev))/lm_idp)*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + (cos(lm_elev)*cos(lm_axis)*cos(lm_circum)*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))/lm_idp)*((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + 2*(((cos(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2)*sin(lm_elev))/lm_idp)*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - ((cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_circum))/lm_idp - (cos(lm_axis)*cos(lm_circum)*sin(lm_elev)*sin(lm_azim - M_PI/2))/lm_idp)*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + (cos(lm_elev)*cos(lm_axis)*cos(lm_circum)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)))/lm_idp)*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(2*pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),1.5))))/(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2) + pow(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)),2)), 
	-1.0*((pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2))*((((cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/pow(lm_idp,2) + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/pow(lm_idp,2))*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) + (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*((sin(lm_elev)*sin(lm_axis))/pow(lm_idp,2) + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/pow(lm_idp,2)) - (2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*((cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/pow(lm_idp,2) + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/pow(lm_idp,2)))/pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),0.5) + ((2*(((cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/pow(lm_idp,2) + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/pow(lm_idp,2))*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*((sin(lm_elev)*sin(lm_axis))/pow(lm_idp,2) + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/pow(lm_idp,2)) + (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*((cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/pow(lm_idp,2) + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/pow(lm_idp,2)))*((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) - 2*(((sin(lm_elev)*sin(lm_axis))/pow(lm_idp,2) + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/pow(lm_idp,2))*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*((cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/pow(lm_idp,2) + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/pow(lm_idp,2)) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*((cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/pow(lm_idp,2) + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/pow(lm_idp,2)))*((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))*((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(2*pow((pow(((lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow((mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*sin(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*cos(lm_circum))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp) + (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - (lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (sin(lm_azim - M_PI/2)*cos(lm_elev)*sin(lm_axis))/lm_idp + (sin(lm_azim - M_PI/2)*cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))),2)),1.5))))/(pow(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp)*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) - (2*mu_qr*mu_qy + 2*mu_qx*mu_qz)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_z*(pow(mu_qr,2) - pow(mu_qx,2) - pow(mu_qy,2) + pow(mu_qz,2)) + mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)),2) + pow(((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - mu_x*(pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2)) - (2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) + (pow(mu_qr,2) + pow(mu_qx,2) - pow(mu_qy,2) - pow(mu_qz,2))*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)),2) + pow(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_x + (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp) + mu_y*(pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2)) - (pow(mu_qr,2) - pow(mu_qx,2) + pow(mu_qy,2) - pow(mu_qz,2))*(lm_y + (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp + (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp) - (2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_z + (sin(lm_elev)*sin(lm_axis))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/lm_idp) - mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)),2));

	return B;
}

inline Eigen::MatrixXd jacobian_idp_to_euc(Eigen::MatrixXd lm){

	double lm_azim = lm(3,0);
	double lm_elev = lm(4,0);
	double lm_axis = lm(5,0);
	double lm_circum = lm(6,0);
	double lm_idp = lm(7,0);

	Eigen::MatrixXd F(3,8);

	F<< 1, 0, 0, (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/lm_idp - (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp,   (sin(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_elev)*cos(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp, -1.0*(cos(lm_elev)*cos(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_circum)*cos(lm_azim - M_PI/2)*sin(lm_axis))/lm_idp - (sin(lm_elev)*sin(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp,   (cos(lm_axis)*cos(lm_circum)*sin(lm_elev)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_circum))/lm_idp, (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/pow(lm_idp,2),
     0, 1, 0, (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_axis)*sin(lm_elev)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp, -1.0*(cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_axis))/lm_idp - (cos(lm_elev)*cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_circum))/lm_idp,   (cos(lm_elev)*cos(lm_axis)*cos(lm_azim - M_PI/2))/lm_idp - (cos(lm_circum)*sin(lm_axis)*sin(lm_azim - M_PI/2))/lm_idp + (cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_axis)*sin(lm_circum))/lm_idp, -1.0*(cos(lm_axis)*sin(lm_circum)*sin(lm_azim - M_PI/2))/lm_idp - (cos(lm_axis)*cos(lm_circum)*cos(lm_azim - M_PI/2)*sin(lm_elev))/lm_idp, (cos(lm_axis)*cos(lm_azim - M_PI/2)*sin(lm_elev)*sin(lm_circum))/pow(lm_idp,2) - (cos(lm_axis)*cos(lm_circum)*sin(lm_azim - M_PI/2))/pow(lm_idp,2) - (cos(lm_elev)*cos(lm_azim - M_PI/2)*sin(lm_axis))/pow(lm_idp,2),
     0, 0, 1, 0, (cos(lm_elev)*sin(lm_axis))/lm_idp - (cos(lm_axis)*sin(lm_elev)*sin(lm_circum))/lm_idp, (cos(lm_axis)*sin(lm_elev))/lm_idp - (cos(lm_elev)*sin(lm_axis)*sin(lm_circum))/lm_idp, (cos(lm_elev)*cos(lm_axis)*cos(lm_circum))/lm_idp, -1.0*(sin(lm_elev)*sin(lm_axis))/pow(lm_idp,2) - (cos(lm_elev)*cos(lm_axis)*sin(lm_circum))/pow(lm_idp,2);

	return F;
}

}

#endif // EKFJACOBIANS_H
